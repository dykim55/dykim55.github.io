<!DOCTYPE html>
<html>
<head>
  <title>Read Excel File</title>
</head>
<body>
  <input type="file" id="file-input" accept=".xlsx">
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    // 엑셀 파일을 읽어오는 함수
    function readExcelFile(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();

        reader.onload = (event) => {
          const data = new Uint8Array(event.target.result);
          const workbook = XLSX.read(data, { type: 'array' });
          const sheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[sheetName];
          const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

          resolve(jsonData);
        };

        reader.onerror = (event) => {
          reject(event.target.error);
        };

        reader.readAsArrayBuffer(file);
      });
    }

    // 파일 선택 이벤트 핸들러
    document.getElementById('file-input').addEventListener('change', async (event) => {
      const file = event.target.files[0];

      try {
        const jsonData = await readExcelFile(file);
        console.log('Excel data:', jsonData);
        // 읽어온 데이터를 처리하는 로직을 추가하세요.
      } catch (error) {
        console.error('Error reading Excel file:', error);
      }
    });
  </script>
</body>
</html>
